<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CV Interactivo | Juan Ramon Moreno Bravo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Calm Professional -->
    <!-- Application Structure Plan: Se ha diseñado una SPA con una estructura de panel de control (dashboard) para una exploración no lineal. Consta de un encabezado fijo, una barra de navegación para saltos rápidos y secciones temáticas (Habilidades, Experiencia, Educación). Se eligió esta estructura porque permite a los reclutadores acceder rápidamente a la información más relevante. Las interacciones clave incluyen un gráfico de habilidades dinámico y una sección de experiencia con pestañas, lo que hace que la información sea más digerible y atractiva que un documento estático, demostrando a su vez las capacidades de desarrollo del candidato. Se han añadido funcionalidades potenciadas por la API de Gemini: un botón para resumir dinámicamente la experiencia laboral seleccionada y otro para generar preguntas de entrevista basadas en el perfil, mejorando la interacción y utilidad de la aplicación. -->
    <!-- Visualization & Content Choices:
        - Info: Habilidades Técnicas -> Goal: Comparar áreas de competencia -> Viz: Gráfico Radar (Chart.js/Canvas) -> Interaction: Hover para ver detalles. Botones para filtrar listas de habilidades por categoría -> Justification: Visualiza rápidamente fortalezas y diversificación de habilidades.
        - Info: Experiencia Laboral -> Goal: Organizar cronológicamente -> Viz: Pestañas interactivas (HTML/CSS/JS) -> Interaction: Clic para mostrar detalles de cada puesto y un botón "✨ Resumir Experiencia" para obtener un resumen generado por IA -> Justification: Evita un bloque de texto largo, manteniendo la interfaz limpia y controlada por el usuario, y añade valor con la capacidad de resumen.
        - Info: Educación y Certificaciones -> Goal: Informar claramente -> Viz: Tarjetas de contenido (HTML/Tailwind) -> Interaction: Sutil efecto hover -> Justification: Organiza la información en bloques visualmente distintos y fáciles de leer. Se han expandido las certificaciones en tarjetas individuales para mayor claridad.
        - Info: Perfil General -> Goal: Proporcionar utilidad al usuario o reclutador -> Viz: Botón "✨ Generar Preguntas de Entrevista" -> Interaction: Clic para obtener preguntas relevantes generadas por IA en un modal -> Justification: Añade una funcionalidad innovadora y práctica para preparación o evaluación.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F8F9FA;
            color: #212529;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }
        .nav-link {
            transition: color 0.3s, border-bottom-color 0.3s;
            border-bottom: 2px solid transparent;
        }
        .nav-link:hover, .nav-link.active {
            color: #0d6efd;
            border-bottom-color: #0d6efd;
        }
        .tab.active {
            border-color: #0d6efd;
            background-color: #e7f0fe;
            color: #0d6efd;
        }
        .card-hover {
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background-color: #fff;
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            transform: translateY(-20px);
            transition: transform 0.3s ease;
        }
        .modal-overlay.show .modal-content {
            transform: translateY(0);
        }
        .modal-close-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
            transition: color 0.2s;
        }
        .modal-close-btn:hover {
            color: #333;
        }
        /* Loading Spinner */
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #0d6efd;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            display: inline-block;
            vertical-align: middle;
            margin-right: 8px;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="antialiased">

    <header class="bg-white/80 backdrop-blur-sm shadow-sm sticky top-0 z-50">
        <nav class="container mx-auto px-6 py-3 flex justify-between items-center">
            <h1 class="text-xl font-bold text-gray-800">Juan Ramon Moreno Bravo</h1>
            <div class="hidden md:flex space-x-8">
                <a href="#intro" class="nav-link text-gray-600 font-medium pb-1">Inicio</a>
                <a href="#skills" class="nav-link text-gray-600 font-medium pb-1">Habilidades</a>
                <a href="#experience" class="nav-link text-gray-600 font-medium pb-1">Experiencia</a>
                <a href="#education" class="nav-link text-gray-600 font-medium pb-1">Formación</a>
                <a href="#contact" class="nav-link text-gray-600 font-medium pb-1">Contacto</a>
            </div>
            <div class="md:hidden">
                <button id="menu-btn" class="text-gray-600 focus:outline-none">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
                </button>
            </div>
        </nav>
        <div id="mobile-menu" class="hidden md:hidden">
            <a href="#intro" class="block py-2 px-4 text-sm text-gray-700 hover:bg-gray-100">Inicio</a>
            <a href="#skills" class="block py-2 px-4 text-sm text-gray-700 hover:bg-gray-100">Habilidades</a>
            <a href="#experience" class="block py-2 px-4 text-sm text-gray-700 hover:bg-gray-100">Experiencia</a>
            <a href="#education" class="block py-2 px-4 text-sm text-gray-700 hover:bg-gray-100">Formación</a>
            <a href="#contact" class="block py-2 px-4 text-sm text-gray-700 hover:bg-gray-100">Contacto</a>
        </div>
    </header>

    <main class="container mx-auto px-6 py-12">
        <section id="intro" class="text-center min-h-[60vh] flex flex-col justify-center items-center">
            <h2 class="text-4xl md:text-6xl font-bold text-gray-800 leading-tight">Desarrollador Web Multiplataforma</h2>
            <p class="mt-4 text-lg text-gray-600 max-w-2xl">
                Busco una oportunidad de prácticas o un puesto junior para aplicar mis habilidades en el diseño y la implementación de soluciones web, contribuyendo al crecimiento y la innovación de un equipo dinámico.
            </p>
            <div class="mt-8 flex flex-col sm:flex-row gap-4">
                <a href="#contact" class="px-8 py-3 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 transition-colors duration-300">Contáctame</a>
                <button id="generate-questions-btn" class="px-8 py-3 bg-green-600 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 transition-colors duration-300">
                    <span id="questions-btn-text" class="btn-text">✨ Generar Preguntas de Entrevista</span>
                    <span id="questions-btn-spinner" class="spinner hidden"></span>
                </button>
            </div>
        </section>

        <section id="skills" class="py-20">
            <div class="text-center mb-12">
                <h3 class="text-3xl font-bold text-gray-800">Habilidades Técnicas</h3>
                <p class="text-gray-600 mt-2 max-w-2xl mx-auto">
                    Esta sección ofrece una vista general de mis competencias técnicas. El gráfico de radar visualiza mis áreas de fortaleza, mientras que las tarjetas detallan tecnologías específicas. Puede interactuar con los botones para filtrar las habilidades por categoría y explorar mi perfil técnico en profundidad.
                </p>
            </div>
            <div class="grid md:grid-cols-2 gap-12 items-center">
                <div class="chart-container">
                    <canvas id="skillsChart"></canvas>
                </div>
                <div>
                    <div class="flex flex-wrap justify-center gap-2 mb-6">
                        <button class="skill-filter-btn px-4 py-2 bg-gray-200 text-gray-800 rounded-full text-sm font-medium" data-category="all">Todas</button>
                        <button class="skill-filter-btn px-4 py-2 bg-gray-200 text-gray-800 rounded-full text-sm font-medium" data-category="frontend">Frontend</button>
                        <button class="skill-filter-btn px-4 py-2 bg-gray-200 text-gray-800 rounded-full text-sm font-medium" data-category="backend">Backend</button>
                        <button class="skill-filter-btn px-4 py-2 bg-gray-200 text-gray-800 rounded-full text-sm font-medium" data-category="tools">Herramientas</button>
                        <button class="skill-filter-btn px-4 py-2 bg-gray-200 text-gray-800 rounded-full text-sm font-medium" data-category="design">Diseño</button>
                    </div>
                    <ul id="skills-list" class="space-y-3">
                    </ul>
                </div>
            </div>
        </section>

        <section id="experience" class="py-20 bg-white rounded-2xl shadow-lg">
             <div class="text-center mb-12 px-4">
                <h3 class="text-3xl font-bold text-gray-800">Experiencia Laboral</h3>
                <p class="text-gray-600 mt-2 max-w-2xl mx-auto">
                    Aquí se detalla mi trayectoria profesional. Utilice las pestañas para navegar entre mis diferentes roles y conocer las responsabilidades y logros en cada uno. Esta sección muestra la aplicación práctica de mis habilidades en entornos reales, desde el desarrollo freelance hasta pasantías corporativas.
                </p>
            </div>
            <div class="max-w-4xl mx-auto">
                <div class="flex border-b border-gray-200 mb-6 justify-center">
                    <button class="tab flex-1 md:flex-initial text-center px-6 py-3 font-medium text-gray-600 border-b-2 border-transparent hover:text-blue-600 active" data-target="freelance">Freelance</button>
                    <button class="tab flex-1 md:flex-initial text-center px-6 py-3 font-medium text-gray-600 border-b-2 border-transparent hover:text-blue-600" data-target="intern">Pasante</button>
                    <button class="tab flex-1 md:flex-initial text-center px-6 py-3 font-medium text-gray-600 border-b-2 border-transparent hover:text-blue-600" data-target="assistant">Auxiliar</button>
                </div>
                <div id="experience-content" class="px-4">
                </div>
            </div>
        </section>

        <section id="education" class="py-20">
             <div class="text-center mb-12">
                <h3 class="text-3xl font-bold text-gray-800">Formación y Certificaciones</h3>
                <p class="text-gray-600 mt-2 max-w-2xl mx-auto">
                    Mi educación formal y aprendizaje continuo son pilares de mi desarrollo. En esta sección se presentan mis títulos académicos y las certificaciones profesionales que he obtenido, las cuales complementan y validan mis conocimientos técnicos en diversas áreas.
                </p>
            </div>
            <div class="grid md:grid-cols-2 gap-8">
                <div>
                    <h4 class="text-xl font-bold text-gray-700 mb-4">Formación Académica</h4>
                    <div class="space-y-6">
                        <div class="bg-white p-6 rounded-lg shadow-md card-hover">
                            <p class="font-bold text-blue-700">Técnico Superior Universitario en Desarrollo de Software Multiplataforma</p>
                            <p class="text-gray-600">Universidad Tecnológica de Tehuacán (UTT)</p>
                            <p class="text-sm text-gray-500">Septiembre 2022 - Noviembre 2024</p>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-md card-hover">
                            <p class="font-bold text-blue-700">Bachillerato General con Especialidad en Redes y Mantenimiento de Ordenadores</p>
                            <p class="text-gray-600">Ciudad del Sol - Tehuacán, Pue.</p>
                            <p class="text-sm text-gray-500">Agosto 2019 - Julio 2022</p>
                        </div>
                         <div class="bg-white p-6 rounded-lg shadow-md card-hover">
                            <p class="font-bold text-blue-700">Secundaria General Raúl López Ramírez</p>
                            <p class="text-gray-600">Tehuacán, Pue.</p>
                            <p class="text-sm text-gray-500">Agosto 2016 - Julio 2019</p>
                        </div>
                    </div>
                </div>
                <div>
                    <h4 class="text-xl font-bold text-gray-700 mb-4">Certificaciones Destacadas</h4>
                    <div class="space-y-4">
                        <div class="bg-white p-4 rounded-lg shadow-sm card-hover flex items-center space-x-4">
                            <span class="text-blue-500">🏆</span>
                            <div>
                                <p class="font-semibold text-gray-800">Curso Profesional en Bases de Datos</p>
                                <p class="text-sm text-gray-500">Código Facilito (2024)</p>
                            </div>
                        </div>
                        <div class="bg-white p-4 rounded-lg shadow-sm card-hover flex items-center space-x-4">
                            <span class="text-blue-500">🏆</span>
                            <div>
                                <p class="font-semibold text-gray-800">Excel: Office Scripts con TypeScript</p>
                                <p class="text-sm text-gray-500">LinkedIn Learning (2024)</p>
                            </div>
                        </div>
                        <div class="bg-white p-4 rounded-lg shadow-sm card-hover flex items-center space-x-4">
                            <span class="text-blue-500">🏆</span>
                            <div>
                                <p class="font-semibold text-gray-800">Fundamentos de Gestión de Proyectos</p>
                                <p class="text-sm text-gray-500">Microsoft & LinkedIn Learning (2025)</p>
                            </div>
                        </div>
                        <div class="bg-white p-4 rounded-lg shadow-sm card-hover flex items-center space-x-4">
                            <span class="text-blue-500">🏆</span>
                            <div>
                                <p class="font-semibold text-gray-800">Introducción a Redes (CCNAv7)</p>
                                <p class="text-sm text-gray-500">Cisco Networking Academy (2023)</p>
                            </div>
                        </div>
                        <div class="bg-white p-4 rounded-lg shadow-sm card-hover flex items-center space-x-4">
                            <span class="text-blue-500">🏆</span>
                            <div>
                                <p class="font-semibold text-gray-800">Switching, Routing and Wireless Essentials (CCNAv7)</p>
                                <p class="text-sm text-gray-500">Cisco Networking Academy (2023)</p>
                            </div>
                        </div>
                        <div class="bg-white p-4 rounded-lg shadow-sm card-hover flex items-center space-x-4">
                            <span class="text-blue-500">🏆</span>
                            <div>
                                <p class="font-semibold text-gray-800">Fundamentos de Programación</p>
                                <p class="text-sm text-gray-500">LinkedIn Learning (2023)</p>
                            </div>
                        </div>
                        <div class="bg-white p-4 rounded-lg shadow-sm card-hover flex items-center space-x-4">
                            <span class="text-blue-500">🏆</span>
                            <div>
                                <p class="font-semibold text-gray-800">Tester</p>
                                <p class="text-sm text-gray-500">Fundación Carlos Slim (2023)</p>
                            </div>
                        </div>
                        <div class="bg-white p-4 rounded-lg shadow-sm card-hover flex items-center space-x-4">
                            <span class="text-blue-500">🏆</span>
                            <div>
                                <p class="font-semibold text-gray-800">Liderazgo</p>
                                <p class="text-sm text-gray-500">Fundación Carlos Slim (2024)</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer id="contact" class="bg-gray-800 text-white">
        <div class="container mx-auto px-6 py-10 text-center">
             <h3 class="text-2xl font-bold">Ponerse en contacto</h3>
             <p class="text-gray-400 mt-2 max-w-xl mx-auto">Estoy disponible para oportunidades de prácticas y puestos junior. No dude en ponerse en contacto conmigo.</p>
             <div class="mt-6 space-y-2">
                <p>📧 <a href="mailto:juanhernandezbravo750@gmail.com" class="hover:text-blue-400">juanhernandezbravo750@gmail.com</a></p>
                <p>📞 <span class="hover:text-blue-400">238-107-00-84 / 238-244-06-37</span></p>
                <p>📍 <span class="hover:text-blue-400">Tehuacán, Puebla, México</span></p>
             </div>
             <div class="mt-6">
                <a href="https://linkedin.com/in/juan-ramon-moreno-bravo-0830b1271" target="_blank" rel="noopener noreferrer" class="inline-block bg-blue-600 px-6 py-2 rounded-full hover:bg-blue-700 transition-colors">LinkedIn</a>
                <a href="https://github.com/juanhernandez11" target="_blank" rel="noopener noreferrer" class="inline-block bg-blue-600 px-6 py-2 rounded-full hover:bg-blue-700 transition-colors">GitHub</a>
             </div>
        </div>
    </footer>

    <!-- Modal Structure -->
    <div id="app-modal" class="modal-overlay">
        <div class="modal-content">
            <span class="modal-close-btn" id="close-modal-btn">&times;</span>
            <h4 id="modal-title" class="text-2xl font-bold mb-4 text-gray-800"></h4>
            <div id="modal-body" class="text-gray-700 leading-relaxed"></div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const skillsData = {
                labels: ['HTML/CSS', 'JavaScript', 'PHP', 'Flutter Web', 'Bases de Datos', 'Frameworks', 'Diseño UI/UX'],
                datasets: [{
                    label: 'Nivel de Habilidad',
                    data: [90, 85, 75, 80, 85, 70, 65],
                    backgroundColor: 'rgba(13, 110, 253, 0.2)',
                    borderColor: 'rgba(13, 110, 253, 1)',
                    pointBackgroundColor: 'rgba(13, 110, 253, 1)',
                    pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff',
                    pointHoverBorderColor: 'rgba(13, 110, 253, 1)'
                }]
            };

            const skillsList = [
                { name: 'HTML', category: 'frontend' },
                { name: 'CSS', category: 'frontend' },
                { name: 'JavaScript', category: 'frontend' },
                { name: 'Angular', category: 'frontend' },
                { name: 'Bootstrap', category: 'frontend' },
                { name: 'Flutter Web', category: 'frontend' },
                { name: 'PHP', category: 'backend' },
                { name: 'MySQL', category: 'backend' },
                { name: 'MongoDB', category: 'backend' },
                { name: 'Git & GitHub', category: 'tools' },
                { name: 'Office Scripts', category: 'tools' },
                { name: 'Google Sheets', category: 'tools' },
                { name: 'Diseño UI/UX Básico', category: 'design' }
            ];

            const ctx = document.getElementById('skillsChart').getContext('2d');
            const skillsChart = new Chart(ctx, {
                type: 'radar',
                data: skillsData,
                options: {
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: { color: 'rgba(0, 0, 0, 0.1)' },
                            grid: { color: 'rgba(0, 0, 0, 0.1)' },
                            pointLabels: { font: { size: 12 }, color: '#333' },
                            ticks: {
                                backdropColor: 'transparent',
                                color: '#666',
                                stepSize: 20
                            }, // Corrected: changed ')' to '}' here
                            suggestedMin: 0,
                            suggestedMax: 100
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });

            const skillsListContainer = document.getElementById('skills-list');
            const skillFilterBtns = document.querySelectorAll('.skill-filter-btn');

            function renderSkills(category) {
                skillsListContainer.innerHTML = '';
                const filteredSkills = category === 'all'
                    ? skillsList
                    : skillsList.filter(skill => skill.category === category);

                filteredSkills.forEach(skill => {
                    const li = document.createElement('li');
                    li.className = 'bg-white p-3 rounded-md shadow-sm flex items-center';
                    li.innerHTML = `<span class="bg-blue-100 text-blue-800 text-sm font-medium mr-3 px-2.5 py-0.5 rounded-full">${skill.category}</span> ${skill.name}`;
                    skillsListContainer.appendChild(li);
                });
            }

            skillFilterBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const category = btn.dataset.category;
                    renderSkills(category);
                    skillFilterBtns.forEach(b => b.classList.remove('bg-blue-600', 'text-white'));
                    btn.classList.add('bg-blue-600', 'text-white');
                });
            });

            document.querySelector('.skill-filter-btn[data-category="all"]').click();


            const experienceData = {
                freelance: {
                    title: 'Desarrollador Web y Soporte Técnico (Freelance)',
                    date: 'Mayo 2021 - Diciembre 2023',
                    location: 'Tehuacán, Pue.',
                    points: [
                        'Desarrollo de sitios web utilizando HTML, CSS, JavaScript, PHP y bases de datos MySQL.',
                        'Desarrollo de aplicaciones web con Flutter Web para interfaces interactivas.',
                        'Implementación de soluciones de gestión de datos utilizando Google Sheets para automatización y análisis.',
                        'Diseño de interfaces de usuario (UI) y experiencia de usuario (UX) básicas para proyectos web.',
                        'Soporte técnico a usuarios en entornos empresariales y educativos.'
                    ]
                },
                intern: {
                    title: 'Pasante de Informática',
                    date: 'Mayo 2024 - Agosto 2024',
                    location: 'Jurisdicción Sanitaria Núm. 10 - Servicios de Salud del Estado de Puebla',
                    points: [
                        'Soporte técnico y mantenimiento informático.',
                        'Gestión básica de sistemas administrativos.',
                        'Desarrollo de un sistema para la eficiencia operativa de equipos de cómputo y control de inventario.'
                    ]
                },
                assistant: {
                    title: 'Auxiliar de Técnico Instalador',
                    date: 'Noviembre 2024 - Marzo 2025',
                    location: 'Solit Wireless y Fibra Óptica - Tehuacán, Pue.',
                    points: [
                        'Instalación y configuración de equipos de telecomunicaciones.',
                        'Mantenimiento preventivo de redes y cableado estructurado.'
                    ]
                }
            };

            const tabs = document.querySelectorAll('.tab');
            const experienceContent = document.getElementById('experience-content');

            function updateExperienceContent(target) {
                const data = experienceData[target];
                let pointsHtml = data.points.map(point => `<li class="flex items-start"><span class="text-blue-500 mr-2 mt-1">◆</span><span>${point}</span></li>`).join('');
                experienceContent.innerHTML = `
                    <div class="bg-gray-50 p-6 rounded-lg">
                        <h4 class="text-xl font-bold text-gray-800">${data.title}</h4>
                        <p class="text-sm text-gray-500 my-2">${data.date} | ${data.location}</p>
                        <ul class="mt-4 space-y-2 text-gray-700">${pointsHtml}</ul>
                        <button class="summarize-experience-btn mt-4 px-4 py-2 bg-purple-600 text-white font-semibold rounded-lg shadow-md hover:bg-purple-700 transition-colors duration-300" data-experience-key="${target}">
                            <span class="summarize-btn-text">✨ Resumir Experiencia</span>
                            <span class="spinner hidden"></span>
                        </button>
                    </div>`;

                document.querySelector('.summarize-experience-btn').addEventListener('click', function() {
                    const experienceKey = this.dataset.experience-key;
                    const fullExperienceText = `${experienceData[experienceKey].title}. ${experienceData[experienceKey].points.join('. ')}`;
                    // Pass the button element itself to the summarizeExperience function
                    summarizeExperience(fullExperienceText, this);
                });
            }

            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const target = tab.dataset.target;
                    tabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    updateExperienceContent(target);
                });
            });

            updateExperienceContent('freelance');

            const menuBtn = document.getElementById('menu-btn');
            const mobileMenu = document.getElementById('mobile-menu');
            menuBtn.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });

            const navLinks = document.querySelectorAll('.nav-link');
            const sections = document.querySelectorAll('section[id]');

            function onScroll() {
                let currentSection = "";
                sections.forEach(section => {
                    const sectionTop = section.offsetTop;
                    if (pageYOffset >= sectionTop - 60) {
                        currentSection = section.getAttribute('id');
                    }
                });

                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href').substring(1) === currentSection) {
                        link.classList.add('active');
                    }
                });
            }
            window.addEventListener('scroll', onScroll);

            // Modal logic
            const appModal = document.getElementById('app-modal');
            const closeModalBtn = document.getElementById('close-modal-btn');
            const modalTitle = document.getElementById('modal-title');
            const modalBody = document.getElementById('modal-body');

            closeModalBtn.addEventListener('click', () => {
                appModal.classList.remove('show');
            });

            appModal.addEventListener('click', (event) => {
                if (event.target === appModal) {
                    appModal.classList.remove('show');
                }
            });

            function showModal(title, content) {
                modalTitle.textContent = title;
                modalBody.innerHTML = content;
                appModal.classList.add('show');
            }

            // Gemini API integration
            const apiKey = ""; // API key will be provided by the Canvas environment at runtime

            async function callGeminiAPI(prompt, buttonElement) {
                // Determine the correct text span and spinner based on the button
                let textSpan;
                let spinner;

                if (buttonElement.id === 'generate-questions-btn') {
                    textSpan = buttonElement.querySelector('#questions-btn-text');
                    spinner = buttonElement.querySelector('#questions-btn-spinner');
                } else if (buttonElement.classList.contains('summarize-experience-btn')) {
                    textSpan = buttonElement.querySelector('.summarize-btn-text');
                    spinner = buttonElement.querySelector('.spinner');
                }

                if (!textSpan || !spinner) {
                    console.error("Error: No se encontraron los elementos de texto o spinner dentro del botón.", buttonElement);
                    return 'Error interno: No se encontraron elementos de interfaz.';
                }

                textSpan.classList.add('hidden');
                spinner.classList.remove('hidden');
                buttonElement.disabled = true;

                let chatHistory = [];
                chatHistory.push({ role: "user", parts: [{ text: prompt }] });
                const payload = { contents: chatHistory };
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    const result = await response.json();
                    if (result.candidates && result.candidates.length > 0 &&
                        result.candidates[0].content && result.candidates[0].content.parts &&
                        result.candidates[0].content.parts.length > 0) {
                        return result.candidates[0].content.parts[0].text;
                    } else {
                        console.error('Unexpected API response structure:', result);
                        return 'Error: No se pudo obtener la respuesta de la IA.';
                    }
                } catch (error) {
                    console.error('Error calling Gemini API:', error);
                    return 'Error al conectar con la IA. Por favor, inténtelo de nuevo.';
                } finally {
                    textSpan.classList.remove('hidden');
                    spinner.classList.add('hidden');
                    buttonElement.disabled = false;
                }
            }

            // Feature 1: Summarize Experience
            async function summarizeExperience(experienceText, buttonElement) {
                const prompt = `Por favor, resume concisamente la siguiente experiencia laboral en español. Enfócate en las responsabilidades clave y logros en no más de 50 palabras: "${experienceText}"`;
                const summary = await callGeminiAPI(prompt, buttonElement); // Pass the button element
                showModal('Resumen de Experiencia', `<p>${summary}</p>`);
            }

            // Feature 2: Generate Interview Questions
            const generateQuestionsBtn = document.getElementById('generate-questions-btn');
            generateQuestionsBtn.addEventListener('click', async function() {
                const profileSummary = `Mi objetivo profesional es ser Desarrollador Web con experiencia en desarrollo multiplataforma, HTML, CSS, JavaScript, PHP, Flutter Web, Angular, Bootstrap, MySQL, MongoDB, Google Sheets, y diseño UI/UX básico. Tengo experiencia como Desarrollador Web y Soporte Técnico freelance, Pasante de Informática y Auxiliar de Técnico Instalador.`;
                const prompt = `Genera 5 preguntas de entrevista comunes para un puesto de desarrollador web junior o para una pasantía, basándote en el siguiente perfil. Las preguntas deben ser variadas y cubrir aspectos técnicos y blandos: "${profileSummary}"`;
                const questionsRaw = await callGeminiAPI(prompt, this); // Pass the button element
                const questionsHtml = questionsRaw.split('\n').filter(q => q.trim() !== '').map(q => `<p>${q}</p>`).join('');
                showModal('Preguntas de Entrevista Sugeridas', questionsHtml);
            });
        });
    </script>
</body>
</html>
